<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title>VBA脚本 · 伍攀.blog</title><meta name="description" content="¶简介
VBA（Visual Basic for Applications）是微软Office系列软件中用于编写宏的脚本语言。VBA可以用来自动化各种工作，如自动填充表格、自动更新公式、自动保存文件等。
¶语法
VBA的语法与其他编程语言有所不同，但也有一些共同之处。
¶1.便利的修改文件夹名称
1"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">伍攀.blog</a></h3></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>孩儿立志出乡关，学不成名誓不还。</span></a><span>—— blog for</span><a target="_blank" rel="noopener" href="https://github.com/wyf2710"> 伍攀</a><div class="by_farbox"></div><span>2025 © 伍攀. All rights reserved.</span><div class="powered-by"><span>Powered by</span><a href="https://hexo.io/zh-cn/" target="_blank"> Hexo</a><span>and</span><a href="https://pages.github.com/" target="_blank">Github Pages</a><span>, Theme by</span><a target="_blank" rel="noopener" href="https://www.caicai.me"> CaiCai</a><span>&</span><a target="_blank" rel="noopener" href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a></div><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span><span> 次</span></span><span id="busuanzi_container_site_uv">本站总访客数<span id="busuanzi_value_site_uv"></span><span> 人</span></span></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/logo.png"></div></div><div class="progress-bar" style="height: 3px; background: #3498db; width: 0%;"><script>window.addEventListener('scroll', function () {
  const bar = document.querySelector('.progress-bar');
  const height = document.documentElement.scrollHeight - window.innerHeight;
  bar.style.width = (window.scrollY / height) * 100 + '%';
});</script></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h1><a>VBA脚本</a></h1></div><div class="post-content"><h2 id="简介"><a class="header-anchor" href="#简介">¶</a>简介</h2>
<p>VBA（Visual Basic for Applications）是微软Office系列软件中用于编写宏的脚本语言。VBA可以用来自动化各种工作，如自动填充表格、自动更新公式、自动保存文件等。</p>
<h2 id="语法"><a class="header-anchor" href="#语法">¶</a>语法</h2>
<p>VBA的语法与其他编程语言有所不同，但也有一些共同之处。</p>
<h4 id="1-便利的修改文件夹名称"><a class="header-anchor" href="#1-便利的修改文件夹名称">¶</a>1.便利的修改文件夹名称</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">Sub 获取与当前文件同级的文件夹()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim currentPath As String</span><br><span class="line">    Dim folderName As String</span><br><span class="line">    Dim folderPath As String</span><br><span class="line">    Dim i As Long</span><br><span class="line">    Dim folder As Object</span><br><span class="line">    Dim fso As Object</span><br><span class="line"></span><br><span class="line">    &#x27; 设置工作表对象</span><br><span class="line">    Set ws = ActiveSheet</span><br><span class="line"></span><br><span class="line">    &#x27; 获取当前工作簿的路径</span><br><span class="line">    currentPath = ThisWorkbook.Path</span><br><span class="line"></span><br><span class="line">    &#x27; 创建文件系统对象</span><br><span class="line">    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br><span class="line">    </span><br><span class="line">    &#x27; 获取文件夹对象</span><br><span class="line">    Set folder = fso.GetFolder(currentPath)</span><br><span class="line"></span><br><span class="line">    &#x27; 填入文件夹名称到 A 列</span><br><span class="line">    i = 1</span><br><span class="line">    For Each folder In folder.SubFolders</span><br><span class="line">        ws.Cells(i, 1).Value = folder.Name</span><br><span class="line">        i = i + 1</span><br><span class="line">    Next folder</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub 更改文件夹名称()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim currentPath As String</span><br><span class="line">    Dim lastRow As Long</span><br><span class="line">    Dim oldName As String</span><br><span class="line">    Dim newName As String</span><br><span class="line">    Dim oldFolderPath As String</span><br><span class="line">    Dim newFolderPath As String</span><br><span class="line">    Dim i As Long</span><br><span class="line"></span><br><span class="line">    &#x27; 设置工作表对象</span><br><span class="line">    Set ws = ActiveSheet</span><br><span class="line"></span><br><span class="line">    &#x27; 获取当前工作簿的路径</span><br><span class="line">    currentPath = ThisWorkbook.Path</span><br><span class="line"></span><br><span class="line">    &#x27; 获取最后一行</span><br><span class="line">    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row</span><br><span class="line"></span><br><span class="line">    &#x27; 更新文件夹名称</span><br><span class="line">    For i = 1 To lastRow</span><br><span class="line">        oldName = ws.Cells(i, 1).Value &#x27; A 列的旧名称</span><br><span class="line">        newName = ws.Cells(i, 3).Value  &#x27; C 列的新名称</span><br><span class="line"></span><br><span class="line">        &#x27; 检查旧名称和新名称是否为空</span><br><span class="line">        If oldName &lt;&gt; &quot;&quot; And newName &lt;&gt; &quot;&quot; Then</span><br><span class="line">            &#x27; 构建完整的旧路径和新路径</span><br><span class="line">            oldFolderPath = currentPath &amp; &quot;\&quot; &amp; oldName</span><br><span class="line">            newFolderPath = currentPath &amp; &quot;\&quot; &amp; newName</span><br><span class="line">            </span><br><span class="line">            &#x27; 更改文件夹名称（如果存在）</span><br><span class="line">            If Dir(oldFolderPath, vbDirectory) &lt;&gt; &quot;&quot; Then</span><br><span class="line">                Name oldFolderPath As newFolderPath</span><br><span class="line">            End If</span><br><span class="line">        End If</span><br><span class="line">    Next i</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>​		以上代码的主要功能是列出 Excel 文件所在目录下的所有文件夹，并允许用户根据这些文件夹的旧名称和新的用户指定名称来重命名它们。主要就是先执行第一段代码，来获取到文件夹的名称贴在A列，然后根据自己的需要，可以通过日期或者序号把新文件夹拼出来贴到C列。图片显示的就是 将B列和A列拼接，在C列录入 <strong>=B1&amp;A1</strong> 即可。C列的新名称设置好后再执行第二段代码就可以将文件夹名称更新过来了。</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>A</strong></th>
<th><strong>B</strong></th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td>旧文件夹名</td>
<td>拼合项</td>
<td>新文件夹名</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>文件夹1</td>
<td>A</td>
<td>A文件夹1</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>文件夹2</td>
<td>B</td>
<td>B文件夹2</td>
</tr>
</tbody>
</table>
<p>在组织和管理文件夹时，用户可以快速查看当前文件夹的所有子文件夹，方便进行重命名或分类。有时需要重命名文件夹以反映不同的阶段或状态，例如将“项目阶段1”重命名为“完成的阶段1”。当某个项目完成时，用户可以将相关文件夹重命名为“已归档 - 项目名称”，便于后续查找。</p>
<hr>
<h4 id="2-修改文件名称"><a class="header-anchor" href="#2-修改文件名称">¶</a>2.<strong>修改文件名称</strong></h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">Sub 获取文件名()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim currentPath As String</span><br><span class="line">    Dim file As Object</span><br><span class="line">    Dim fso As Object</span><br><span class="line">    Dim i As Long</span><br><span class="line"></span><br><span class="line">    &#x27; 设置工作表对象</span><br><span class="line">    Set ws = ActiveSheet</span><br><span class="line"></span><br><span class="line">    &#x27; 获取当前工作簿的路径</span><br><span class="line">    currentPath = ThisWorkbook.Path</span><br><span class="line"></span><br><span class="line">    &#x27; 创建文件系统对象</span><br><span class="line">    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br><span class="line">    </span><br><span class="line">    &#x27; 获取当前目录下的所有文件</span><br><span class="line">    i = 1</span><br><span class="line">    For Each file In fso.GetFolder(currentPath).Files</span><br><span class="line">        &#x27; 跳过 Excel 文件本身</span><br><span class="line">        If LCase(file.Name) &lt;&gt; LCase(ThisWorkbook.Name) Then</span><br><span class="line">            ws.Cells(i, 1).Value = file.Name</span><br><span class="line">            i = i + 1</span><br><span class="line">        End If</span><br><span class="line">    Next file</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub 重命名文件()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim currentPath As String</span><br><span class="line">    Dim lastRow As Long</span><br><span class="line">    Dim oldName As String</span><br><span class="line">    Dim newName As String</span><br><span class="line">    Dim oldFilePath As String</span><br><span class="line">    Dim newFilePath As String</span><br><span class="line">    Dim i As Long</span><br><span class="line"></span><br><span class="line">    &#x27; 设置工作表对象</span><br><span class="line">    Set ws = ActiveSheet</span><br><span class="line"></span><br><span class="line">    &#x27; 获取当前工作簿的路径</span><br><span class="line">    currentPath = ThisWorkbook.Path</span><br><span class="line"></span><br><span class="line">    &#x27; 获取最后一行</span><br><span class="line">    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row</span><br><span class="line"></span><br><span class="line">    &#x27; 更新文件名称</span><br><span class="line">    For i = 1 To lastRow</span><br><span class="line">        oldName = ws.Cells(i, 1).Value &#x27; A 列的旧文件名</span><br><span class="line">        newName = ws.Cells(i, 3).Value  &#x27; C 列的新文件名</span><br><span class="line"></span><br><span class="line">        &#x27; 检查旧名称和新名称是否为空</span><br><span class="line">        If oldName &lt;&gt; &quot;&quot; And newName &lt;&gt; &quot;&quot; Then</span><br><span class="line">            &#x27; 构建完整的旧路径和新路径</span><br><span class="line">            oldFilePath = currentPath &amp; &quot;\&quot; &amp; oldName</span><br><span class="line">            newFilePath = currentPath &amp; &quot;\&quot; &amp; newName</span><br><span class="line">            </span><br><span class="line">            &#x27; 更改文件名称（如果存在）</span><br><span class="line">            If Dir(oldFilePath) &lt;&gt; &quot;&quot; Then</span><br><span class="line">                Name oldFilePath As newFilePath</span><br><span class="line">            End If</span><br><span class="line">        End If</span><br><span class="line">    Next i</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>与第一个例子相似，这个是批量修改文件名称的。</p>
<hr>
<h4 id="3-生成目录链接"><a class="header-anchor" href="#3-生成目录链接">¶</a>3.<strong>生成目录链接</strong></h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Sub 在表中建立所有工作表的链接()</span><br><span class="line">    Dim Pt As Range</span><br><span class="line">    Dim i As Integer</span><br><span class="line">    </span><br><span class="line">    With ActiveSheet</span><br><span class="line">        Set Pt = .Range(&quot;a1&quot;)</span><br><span class="line">        For i = 2 To ThisWorkbook.Worksheets.Count</span><br><span class="line">        .Hyperlinks.Add Anchor:=Pt, Address:=&quot;&quot;, SubAddress:=Worksheets(i).Name &amp; &quot;!A1&quot;</span><br><span class="line">        Set Pt = Pt.Offset(1, 0)</span><br><span class="line">        Next i</span><br><span class="line">    End With</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>这段代码可以在表格里生成 工作簿所有表的链接，相当于一个目录。在表格比较多的时候就可以点击对应表格的链接定位到相应表格。</p>
<hr>
<h4 id="4-禁用-启用右键菜单"><a class="header-anchor" href="#4-禁用-启用右键菜单">¶</a>4.<strong>禁用/启用右键菜单</strong></h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Sub 禁用右键菜单()</span><br><span class="line">    Dim myBar As CommandBar</span><br><span class="line">    For Each myBar In CommandBars</span><br><span class="line">        If myBar.Type = msoBarTypePopup Then</span><br><span class="line">            myBar.Enabled = False</span><br><span class="line">        End If</span><br><span class="line">    Next</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub 启用右键菜单()</span><br><span class="line">    Dim myBar As CommandBar</span><br><span class="line">    For Each myBar In CommandBars</span><br><span class="line">        If myBar.Type = msoBarTypePopup Then</span><br><span class="line">            myBar.Enabled = True</span><br><span class="line">        End If</span><br><span class="line">    Next</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>当我们不希望他人使用右键操作我们的表格文件时，可以设置禁用右键菜单。同时当我们需要是可以启动回来。</p>
<hr>
<h4 id="5-批量生成文件夹"><a class="header-anchor" href="#5-批量生成文件夹">¶</a>5.<strong>批量生成文件夹</strong></h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Sub 批量生成文件夹()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim folderPath As String</span><br><span class="line">    Dim cell As Range</span><br><span class="line">    Dim folderName As String</span><br><span class="line"></span><br><span class="line">    &#x27; 设置当前活动工作表</span><br><span class="line">    Set ws = ActiveSheet </span><br><span class="line"></span><br><span class="line">    &#x27; 获取当前工作簿的路径</span><br><span class="line">    folderPath = ThisWorkbook.Path &amp; &quot;\&quot;</span><br><span class="line"></span><br><span class="line">    &#x27; 遍历第一列的每个单元格，创建文件夹</span><br><span class="line">    For Each cell In ws.Range(&quot;A1:A&quot; &amp; ws.Cells(ws.Rows.Count, 1).End(xlUp).Row)</span><br><span class="line">        folderName = Trim(cell.Value) &#x27; 获取文件夹名称，并去除空格</span><br><span class="line">        If folderName &lt;&gt; &quot;&quot; Then &#x27; 如果文件夹名称不为空</span><br><span class="line">            On Error Resume Next &#x27; 忽略错误（如文件夹已存在）</span><br><span class="line">            MkDir folderPath &amp; folderName &#x27; 创建文件夹</span><br><span class="line">            On Error GoTo 0 &#x27; 恢复错误处理</span><br><span class="line">        End If</span><br><span class="line">    Next cell</span><br><span class="line"></span><br><span class="line">    MsgBox &quot;文件夹创建完成！&quot;, vbInformation</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>该代码是将A列的目录名称生成对应的文件夹，非常适合需要根据 Excel 表格中的数据批量创建文件夹的场景。例如，用户可能有一份包含项目名称、客户名称或其他标识符的列表，想要快速生成相应的文件夹以便于组织和管理文件。自动化工作流程：通过自动化这个过程，可以节省时间和人力资源，提高工作效率。适用于多种场景：无论在项目管理、文件整理、数据分类等不同工作领域，均可应用此代码来快速建立所需的文件夹结构。</p>
<hr>
<h4 id="6-导出图表"><a class="header-anchor" href="#6-导出图表">¶</a>6.<strong>导出图表</strong></h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Sub 导出图表()</span><br><span class="line">    Dim ChartPath As String</span><br><span class="line">    ChartPath = ThisWorkbook.Path &amp; &quot;\&quot; &amp; &quot;MyChart.jpg&quot;</span><br><span class="line">    On Error Resume Next</span><br><span class="line">    Kill ChartPath</span><br><span class="line">    Sheet1.ChartObjects(1).Chart.Export FileName:=ChartPath, Filtername:=&quot;JPG&quot;</span><br><span class="line">    MsgBox &quot;图表已保存在&quot;&quot;&quot; &amp; ThisWorkbook.Path &amp; &quot;&quot;&quot;文件夹中!&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>​		这段 VBA 代码的目的是将 Excel 工作表中的第一个图表导出为 JPEG 格式的图片，并保存到与当前工作簿相同的目录中。通过对代码的改变可以批量导出表格中所有生成的图表，适用于需要将 Excel 中的图表导出为图片格式的场景。用户可以将图表嵌入到报告、演示文稿或其他文档中。</p>
<hr>
<h4 id="7-禁用复制剪切粘贴快捷键"><a class="header-anchor" href="#7-禁用复制剪切粘贴快捷键">¶</a>7.<strong>禁用复制剪切粘贴快捷键</strong></h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Private Sub Workbook_Open()</span><br><span class="line">    Application.OnKey &quot;^c&quot;, &quot;&quot; &#x27; 禁用 Ctrl+C</span><br><span class="line">    Application.OnKey &quot;^v&quot;, &quot;&quot; &#x27; 禁用 Ctrl+V</span><br><span class="line">    Application.OnKey &quot;^x&quot;, &quot;&quot; &#x27; 禁用 Ctrl+X</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Private Sub Workbook_BeforeClose(Cancel As Boolean)</span><br><span class="line">    &#x27; 恢复默认功能，确保关闭工作簿时不会影响其他工作簿</span><br><span class="line">    Application.OnKey &quot;^c&quot;</span><br><span class="line">    Application.OnKey &quot;^v&quot;</span><br><span class="line">    Application.OnKey &quot;^x&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>毋庸置疑</p>
<hr>
<p>……</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2025-04-22</span><i class="fa fa-tag"></i><a class="tag" href="/categories/VBA/" title="VBA">VBA </a><a class="tag" href="/tags/excel/" title="excel">excel </a><a class="tag" href="/tags/vba/" title="vba">vba </a><a class="tag" href="/tags/office/" title="office">office </a><i class="fa fa-eye"><span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></i></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://example.com/2025/04/22/VBA脚本/,伍攀.blog,VBA脚本,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2025/04/23/%E6%B7%B1%E5%9C%B3%E6%B8%B8-1/" title="深圳游-1">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2025/04/21/%E6%B2%B9%E7%8C%B4%E8%84%9A%E6%9C%AC/" title="什么是油猴脚本？为什么全网都在用？">下一篇</a></li></ul></div><div id="utter"></div><script>document.addEventListener('DOMContentLoaded', function() {
  const container = document.getElementById('utter');
  if (!container) {
    console.error('Error: #utter container not found');
    return;
  }
  const script = document.createElement('script');
  script.src = 'https://utteranc.es/client.js';
  script.setAttribute('repo', 'wyf2710/wyf2710-blog-comments');
  script.setAttribute('issue-term', 'pathname');
  script.setAttribute('theme', '');
  script.crossOrigin = 'anonymous';
  script.async = true;
  container.appendChild(script);
});</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>